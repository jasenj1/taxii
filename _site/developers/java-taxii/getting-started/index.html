<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>java-taxii | Getting Started | TAXII Project Documentation</title>
    <meta name="viewport" content="width=device-width">

    <!-- bootstrap CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-35443076-1']);
      _gaq.push(['_setDomainName', 'taxiiproject.github.io'])
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>

</head>

  <body>

    <div class="navbar navbar-inverse navbar-static-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">TAXII Docs</a>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
          <li role="presentation"><a href="/getting-started">Getting Started</a></li>
          <!-- <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">

            <li role="presentation" class="divider"></li>
            <li role="presentation" class="dropdown-header">Documents</li>
            <li role="presentation"><a href="http://makingsecuritymeasurable.mitre.org/docs/taxii-intro-handout.pdf" target="_blank">Introductory Brochure</a></li>
            <li role="presentation"><a href="http://taxii.mitre.org/about/documents/Introduction_to_TAXII_White_Paper_May_2014.pdf" target="_blank">Whitepaper (PDF)</a></li>
            <li role="presentation"><a href="http://stix.mitre.org/training/" target="_blank">Training Materials</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a href="/documentation">Documentation Home</a></li>
            <li role="presentation"><a href="/developers">Developers Home</a></li>
            <!-- <li role="presentation" class="dropdown-header">TAXII Libraries</li>
            <li role="presentation"><a href="http://libtaxii.readthedocs.org/en/latest/getting_started.html">libtaxii</a></li>
            <li role="presentation"><a href="http://taxii-services.readthedocs.org/en/latest/getting_started.html">django-taxii-services</a></li>
            <li role="presentation"><a href="/java-taxii/getting-started">java-taxii</a></li>
            <li role="presentation"><a href="https://github.com/TAXIIProject/yeti">YETI</a></li>
          </ul>
        </li> -->

        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li role="presentation"><a href="/documentation">Documentation Home</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a href="/documentation/service-profiles">TAXII Service Profiles</a></li>
            <li role="presentation"><a href="/documentation/faq">TAXII FAQ</a></li>
          </ul>
        </li>

        <li class="dropdown">
         <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers<span class="caret"></span></a>
         <ul class="dropdown-menu" role="menu">
           <li role="presentation"><a href="/developers">Developers Home</a></li>
           <li role="presentation" class="divider"></li>
           <li role="presentation"><a href="/developers/libtaxii">libtaxii</a></li>
           <li role="presentation"><a href="/developers/taxii-services">django-taxii-services</a></li>
           <li role="presentation"><a href="/developers/java-taxii">java-taxii</a></li>
         </ul>
        </li>

    </div>
  </div>
</div>


    <div class="container">
      <h1>java-taxii | Getting Started</h1>
      <h3 id="introduction">Introduction</h3>

<p>The java-taxii library is designed to aid developers writing programs that create and manipulate TAXII messages.
You should be familiar with TAXII before reading this document. The java-taxii library is built using JAXB to 
convert the TAXII XML schema documents into Java object representations. Some familiarity with JAXB will be helpful
in understanding the organization and usage of the library.</p>

<p>java-taxii provides classes to interact with TAXII service providers over HTTP/S. These classes use
Apache&#39;s HTTP Components library to establish the HTTP connection and transport the messages. Familiarity with
the Apache HTTP Components library, especially the CloseableHTTPClient class, will be helpful when using java-taxii.</p>

<h3 id="installation">Installation</h3>

<p><a href="../#downloads">Download</a> the java-taxii .jar and place it in your classpath.</p>

<h4 id="dependencies">Dependencies</h4>

<ul>
<li><p><a href="https://jaxb.java.net">Java XML Bind (JAXB) API</a></p>

<p>Provides the standard JAXB runtime environment.</p></li>
<li><p><a href="http://confluence.highsource.org/display/J2B/Home">JAXB2 Basics</a></p>

<p>This library provides extensions to the standard JAXB environment.</p></li>
<li><p><a href="http://saxon.sourceforge.net">Saxon XSLT processor</a></p>

<p>Provides Schematron validation support.</p></li>
<li><p><a href="http://hc.apache.org/httpcomponents-client-ga/index.html">Apache HTTP Components Client</a></p>

<p>Provides HTTP connection support.</p></li>
</ul>

<p>All of these dependencies are available in the Maven Central repository. It is recommended that you use
a build environment that installs the required libraries from there.</p>

<p>java-taxii uses the Gradle build tool. Below is an example of importing the dependencies using Gradle:</p>
<div class="highlight"><pre><code class="language-java" data-lang="java">    <span class="n">repositories</span> <span class="o">{</span>
        <span class="n">mavenCentral</span><span class="o">()</span>
    <span class="o">}</span>

    <span class="n">dependencies</span> <span class="o">{</span>
        <span class="n">compile</span> <span class="err">&#39;</span><span class="n">javax</span><span class="o">.</span><span class="na">xml</span><span class="o">.</span><span class="na">bind</span><span class="o">:</span><span class="n">jaxb</span><span class="o">-</span><span class="nl">api:</span><span class="mf">2.2</span><span class="o">.+</span><span class="err">&#39;</span>
        <span class="n">compile</span> <span class="err">&#39;</span><span class="n">org</span><span class="o">.</span><span class="na">jvnet</span><span class="o">.</span><span class="na">jaxb2_commons</span><span class="o">:</span><span class="n">jaxb2</span><span class="o">-</span><span class="n">basics</span><span class="o">-</span><span class="nl">runtime:</span><span class="mf">0.6</span><span class="o">.</span><span class="mi">5</span><span class="err">&#39;</span>
        <span class="n">compile</span> <span class="err">&#39;</span><span class="n">net</span><span class="o">.</span><span class="na">sf</span><span class="o">.</span><span class="na">saxon</span><span class="o">:</span><span class="n">Saxon</span><span class="o">-</span><span class="nl">HE:</span><span class="mf">9.5</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="err">&#39;</span>
        <span class="n">compile</span> <span class="err">&#39;</span><span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">httpcomponents</span><span class="o">:</span><span class="nl">httpclient:</span><span class="mf">4.3</span><span class="o">.</span><span class="mi">5</span><span class="err">&#39;</span>
        <span class="n">compile</span> <span class="err">&#39;</span><span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">httpcomponents</span><span class="o">:</span><span class="n">httpclient</span><span class="o">-</span><span class="nl">cache:</span><span class="mf">4.3</span><span class="o">.</span><span class="mi">5</span><span class="err">&#39;</span>
        <span class="n">compile</span> <span class="err">&#39;</span><span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">httpcomponents</span><span class="o">:</span><span class="nl">httpmime:</span><span class="mf">4.3</span><span class="o">.</span><span class="mi">5</span><span class="err">&#39;</span>
        <span class="n">compile</span> <span class="err">&#39;</span><span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">httpcomponents</span><span class="o">:</span><span class="n">fluent</span><span class="o">-</span><span class="nl">hc:</span><span class="mf">4.3</span><span class="o">.</span><span class="mi">5</span><span class="err">&#39;</span>    
        <span class="n">compile</span> <span class="nf">files</span><span class="o">(</span><span class="n">lib</span><span class="o">/</span><span class="n">java</span><span class="o">-</span><span class="n">taxii</span><span class="o">.</span><span class="na">jar</span><span class="err">&#39;</span><span class="o">)</span>
    <span class="o">}</span>
</code></pre></div>
<h3 id="sample-usage">Sample Usage</h3>

<p>It is strongly recommended that you examine the unit test source files for examples of
using the library. There are many tests for object creation of various complexity, 
tests demonstrating validation, and tests of the client.</p>

<h4 id="object-creation">Object Creation</h4>

<p>The simplest usage of the library is to create TAXII message objects</p>
<div class="highlight"><pre><code class="language-java" data-lang="java">    <span class="kn">import</span> <span class="nn">org.mitre.taxii.messages.xml11.ObjectFactory</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.mitre.taxii.messages.xml11.DiscoveryRequest</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.mitre.taxii.messages.xml11.MessageHelper</span><span class="o">;</span>

    <span class="o">...</span>
    <span class="n">ObjectFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">ObjectFactory</span><span class="o">();</span>
    <span class="n">DiscoveryRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">createDiscoveryRequest</span><span class="o">().</span><span class="na">withMessageId</span><span class="o">(</span><span class="n">MessageHelper</span><span class="o">.</span><span class="na">generateMessageId</span><span class="o">());</span>
</code></pre></div>
<h4 id="message-marshaling">Message Marshaling</h4>

<p>Once a TAXII message object is created, the next step is to render it as XML. To do this, you need a JAXB context that
understands how to marshal, or serialize, the object to XML. This context is provided by a TaxiiXml object which is created
using a TaxiiXmlFactory. There is a fair bit of configuration work done by the TaxiiXmlFactory, so it should
always be used to create a properly configured TaxiiXml instance.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java">    <span class="kn">import</span> <span class="nn">org.mitre.taxii.messages.xml11.TaxiiXmlFactory</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.mitre.taxii.messages.xml11.TaxiiXml</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.mitre.taxii.messages.xml11.ObjectFactory</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.mitre.taxii.messages.xml11.DiscoveryRequest</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.mitre.taxii.messages.xml11.MessageHelper</span><span class="o">;</span>
    <span class="o">...</span>

    <span class="n">TaxiiXmlFactory</span> <span class="n">txf</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">TaxiiXmlFactory</span><span class="o">();</span>
    <span class="n">TaxiiXml</span> <span class="n">taxiiXml</span> <span class="o">=</span> <span class="n">txf</span><span class="o">.</span><span class="na">createTaxiiXml</span><span class="o">();</span>

    <span class="n">ObjectFactory</span> <span class="n">of</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">ObjectFactory</span><span class="o">();</span>
    <span class="n">DiscoveryRequest</span> <span class="n">dr</span> <span class="o">=</span> <span class="n">of</span><span class="o">.</span><span class="na">createDiscoveryRequest</span><span class="o">().</span><span class="na">withMessageId</span><span class="o">(</span><span class="n">MessageHelper</span><span class="o">.</span><span class="na">generateMessageId</span><span class="o">());</span>

    <span class="n">String</span> <span class="n">xmlString</span> <span class="o">=</span> <span class="n">taxiiXml</span><span class="o">.</span><span class="na">marshalToString</span><span class="o">(</span><span class="n">dr</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
</code></pre></div>
<h4 id="message-unmarshaling">Message Unmarshaling</h4>

<p>To parse an XML string into an object representation is also done using a TaxiiXml object.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java">    <span class="kn">import</span> <span class="nn">javax.xml.bind.Unmarshaller</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.mitre.taxii.messages.xml11.TaxiiXmlFactory</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.mitre.taxii.messages.xml11.TaxiiXml</span><span class="o">;</span>
    <span class="o">...</span>

    <span class="n">String</span> <span class="n">xml</span> <span class="o">=</span> <span class="s">&quot;&lt;Status_Message status_type=&#39;SUCCESS&#39; in_response_to=&#39;urn:uuid:8fef148a-b186-45a0-a2da-9915daf621b1&#39; &quot;</span>
                 <span class="o">+</span><span class="s">&quot; message_id=&#39;SM02&#39; xmlns=&#39;http://taxii.mitre.org/messages/taxii_xml_binding-1.1&#39;/&gt;&quot;</span><span class="o">;</span>

    <span class="n">TaxiiXmlFactory</span> <span class="n">txf</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">TaxiiXmlFactory</span><span class="o">();</span>
    <span class="n">TaxiiXml</span> <span class="n">taxiiXml</span> <span class="o">=</span> <span class="n">txf</span><span class="o">.</span><span class="na">createTaxiiXml</span><span class="o">();</span>

    <span class="n">Unmarshaller</span> <span class="n">unmarshaller</span> <span class="o">=</span> <span class="n">taxiiXml</span><span class="o">.</span><span class="na">getJaxbContext</span><span class="o">().</span><span class="na">createUnmarshaller</span><span class="o">();</span>

    <span class="n">StatusMessage</span> <span class="n">message</span> <span class="o">=</span> <span class="o">(</span><span class="n">StatusMessage</span><span class="o">)</span> <span class="n">unmarshaller</span><span class="o">.</span><span class="na">unmarshal</span><span class="o">(</span><span class="k">new</span> <span class="nf">StringReader</span><span class="o">(</span><span class="n">xml</span><span class="o">));</span>
</code></pre></div>
<p>Notice that you need to know the type of the item being parsed beforehand. The Unmarshaller will return an Object which 
must be cast to the expected type.</p>

<h4 id="validation">Validation</h4>

<p>Creating and unmarshaling TAXII items does not guarantee that they are schema or business rule valid. You could create an
object and not populate member objects that the schema requires. For example, a Status Message with status type of &quot;PENDING&quot;
is required to have a Status Detail with name &quot;ESTIMATED_WAIT&quot;; further, the value of the Status Detail must be a positive
integer. Those interrelations and constraints cannot be expressed using XML Schema. Instead, they are expressed as
<a href="http://www.schematron.com">Schematron</a> rules embedded within the schema.</p>

<p>Java-taxii provides a few different ways to validate TAXII items. TaxiiXml provides two methods to do validation: validateFast() and 
validateAll(). ValidateFast() will return after the first error is encountered while validateAll() will build a list of validation errors.
Each method also has a boolean parameter &quot;checkSpecConformance&quot; which uses Schematron rules to perform specification conformance checks beyond what XML Schema
supports.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java">    <span class="n">ObjectFactory</span> <span class="n">of</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">ObjectFactory</span><span class="o">();</span> <span class="c1">// JAXB factory for TAXII </span>
    <span class="n">TaxiiXmlFactory</span> <span class="n">txf</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">TaxiiXmlFactory</span><span class="o">();</span> <span class="c1">// Create a factory with the default configuration.</span>
    <span class="n">TaxiiXml</span> <span class="n">taxiiXml</span> <span class="o">=</span> <span class="n">txf</span><span class="o">.</span><span class="na">createTaxiiXml</span><span class="o">();</span> <span class="c1">// get a properly configured TaxiiXml</span>

    <span class="n">DiscoveryMessage</span> <span class="n">dm</span> <span class="o">=</span> <span class="n">of</span><span class="o">.</span><span class="na">createDiscoveryMessage</span><span class="o">()</span>
                            <span class="o">.</span><span class="na">withMessageId</span><span class="o">(</span><span class="n">MessageHelper</span><span class="o">.</span><span class="na">generateMessageId</span><span class="o">());</span>

    <span class="k">try</span> <span class="o">{</span>
        <span class="n">Validation</span> <span class="n">results</span> <span class="o">=</span> <span class="n">taxiiXml</span><span class="o">.</span><span class="na">validateFast</span><span class="o">(</span><span class="n">dm</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span> <span class="c1">// Validate, failing on first error encountered, and perfoming Schematron validation.</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">results</span><span class="o">.</span><span class="na">hasWarnings</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&quot;Validation warnings: &quot;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">results</span><span class="o">.</span><span class="na">getAllWarnings</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SAXParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&quot;Validation error: &quot;</span><span class="o">);</span>
       <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Validation</span><span class="o">.</span><span class="na">formatException</span><span class="o">(</span><span class="n">e</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SAXException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&quot;Validation error: &quot;</span><span class="o">);</span>
           <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></div>
<h4 id="client">Client</h4>

<p>The TAXII HttpClient class facilitates the sending of TAXII messages to a TAXII service.
The TAXII HttpClient uses a TaxiiXml object that provides the JAXB context, and an
Apache HttpClient that provides the actual HTTP protocol connection and transport support.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java">    <span class="n">HttpClient</span> <span class="n">taxiiClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="o">();</span>

    <span class="kd">final</span> <span class="n">String</span> <span class="n">serverUrl</span> <span class="o">=</span> <span class="s">&quot;http://127.0.0.1:8080/services/discovery/&quot;</span><span class="o">;</span>

    <span class="c1">// Prepare the message to send.</span>
    <span class="n">DiscoveryRequest</span> <span class="n">dr</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">createDiscoveryRequest</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withMessageId</span><span class="o">(</span><span class="n">MessageHelper</span><span class="o">.</span><span class="na">generateMessageId</span><span class="o">());</span>

    <span class="c1">// Call the services</span>
    <span class="n">Object</span> <span class="n">responseObj</span> <span class="o">=</span> <span class="n">taxiiClient</span><span class="o">.</span><span class="na">callTaxiiService</span><span class="o">(</span><span class="k">new</span> <span class="nf">URI</span><span class="o">(</span><span class="n">serverUrl</span><span class="o">),</span> <span class="n">dr</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">responseObj</span> <span class="k">instanceof</span> <span class="n">DiscoveryResponse</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">DiscoveryResponse</span> <span class="n">dResp</span> <span class="o">=</span> <span class="o">(</span><span class="n">DiscoveryResponse</span><span class="o">)</span> <span class="n">responseObj</span><span class="o">;</span>
        <span class="n">processDiscoveryResponse</span><span class="o">(</span><span class="n">dResp</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">responseObj</span> <span class="k">instanceof</span> <span class="n">StatusMessage</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StatusMessage</span> <span class="n">sm</span> <span class="o">=</span> <span class="o">(</span><span class="n">StatusMessage</span><span class="o">)</span> <span class="n">responseObj</span><span class="o">;</span>
        <span class="n">processStatusMessage</span><span class="o">(</span><span class="n">sm</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div>
<h4 id="advanced-client">Advanced Client</h4>

<p>The default constuctor for the TAXII HttpClient provides a very simple Apache HttpClient.
However, the TAXII HttpClient can be provided a preconfigured Apache HttpClient.
The Apache HttpClient is a very rich object with many configuration options - especially 
in the area of security. Below is an example of using an Apache HttpClient configured to 
do basic username &amp; password authentication.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java">    <span class="c1">// Create a client that uses basic authentication (user &amp; password).</span>
    <span class="n">HttpClientBuilder</span> <span class="n">cb</span> <span class="o">=</span> <span class="n">HttpClientBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
    <span class="n">CredentialsProvider</span> <span class="n">credsProvider</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">BasicCredentialsProvider</span><span class="o">();</span>
    <span class="n">credsProvider</span><span class="o">.</span><span class="na">setCredentials</span><span class="o">(</span>
            <span class="n">AuthScope</span><span class="o">.</span><span class="na">ANY</span><span class="o">,</span>
            <span class="k">new</span> <span class="nf">UsernamePasswordCredentials</span><span class="o">(</span><span class="s">&quot;taxii&quot;</span><span class="o">,</span> <span class="s">&quot;taxii&quot;</span><span class="o">));</span>        
    <span class="n">cb</span><span class="o">.</span><span class="na">setDefaultCredentialsProvider</span><span class="o">(</span><span class="n">credsProvider</span><span class="o">);</span>        
    <span class="n">CloseableHttpClient</span> <span class="n">httpClient</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>

    <span class="c1">// Create a Taxii Client with the HttpClient object.</span>
    <span class="n">HttpClient</span> <span class="n">taxiiClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="o">(</span><span class="n">httpClient</span><span class="o">);</span>

    <span class="c1">// Prepare the message to send.</span>
    <span class="n">DiscoveryRequest</span> <span class="n">dr</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">createDiscoveryRequest</span><span class="o">()</span>
            <span class="o">.</span><span class="na">withMessageId</span><span class="o">(</span><span class="n">MessageHelper</span><span class="o">.</span><span class="na">generateMessageId</span><span class="o">());</span>

    <span class="c1">// Call the service</span>
    <span class="kd">final</span> <span class="n">String</span> <span class="n">serverUrl</span> <span class="o">=</span> <span class="s">&quot;http://127.0.0.1:8100/services/discovery/&quot;</span><span class="o">;</span>
    <span class="n">Object</span> <span class="n">responseObj</span> <span class="o">=</span> <span class="n">taxiiClient</span><span class="o">.</span><span class="na">callTaxiiService</span><span class="o">(</span><span class="k">new</span> <span class="nf">URI</span><span class="o">(</span><span class="n">serverUrl</span><span class="o">),</span> <span class="n">dr</span><span class="o">);</span>
</code></pre></div>
    </div>

    <div id="footer">
  <hr />
  <div class="container">
    <p class="text-muted">
      Copyright 2015 The MITRE Corporation. <a href="http://taxii.mitre.org/about/termsofuse.html">Terms of Use</a>
    </p>
  </div>
</div>

<!-- jQuery JS -->
<script src="/js/jquery.min.js"></script>

<!-- bootstrap JS -->
<script src="/js/bootstrap.min.js"></script>

<!-- typeahead JS -->
<script src="/js/typeahead.min.js"></script>

<!-- Custom JS -->
<script src="/js/main.js"></script>

  </body>
</html>
